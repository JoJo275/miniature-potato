# 🥔 Miniature Potato - Smart Research Notes Database

A powerful, self-contained Smart Research Notes Database powered by SQLite with AI-powered semantic search capabilities using OpenAI embeddings.

**All Files are generated by AI language models to demonstrate the project structure and functionality. Everything is for demonstration purposes only.**

## 🚀 Features

### Core Capabilities
- **🔍 Full-Text Search** - Lightning-fast text search using SQLite's FTS5
- **🧠 AI Semantic Search** - Find related content using OpenAI embeddings
- **📊 JSON Metadata** - Flexible metadata storage with queryable JSON fields
- **🔗 Note Relationships** - Link related notes automatically
- **📈 Analytics Views** - Built-in views for insights and statistics
- **⚡ Performance Optimized** - Indexes, caching, and batch processing

### Advanced Features
- **Automatic Timestamps** - Track creation and modification times
- **Tag Management** - Organize notes with tags and categories
- **Search History** - Track and analyze search patterns
- **Fallback Mechanisms** - Graceful degradation when AI search unavailable
- **Batch Processing** - Efficient embedding generation for large datasets

## 📋 Prerequisites

- Python 3.8 or higher
- SQLite 3.35+ (for JSON support)
- OpenAI API key (for semantic search)
- (Optional) sqlite-vss extension for vector search

## 🛠️ Installation

### 1. Clone the Repository
```bash
git clone https://github.com/yourusername/miniature-potato.git
cd miniature-potato
```

### 2. Install Dependencies

For minimal installation (core features only):
```bash
pip install -r requirements-core.txt
```

For full installation (includes development tools):
```bash
pip install -r requirements.txt
```

### 3. Configure Environment Variables
Create a `.env` file in the root directory:
```env
# OpenAI Configuration
OPENAI_API_KEY=your_openai_api_key_here

# Database Configuration (optional)
DATABASE_PATH=smart_notes.db
EMBEDDING_MODEL=text-embedding-3-small
EMBEDDING_DIMENSION=384

# Performance Settings (optional)
BATCH_SIZE=10
CACHE_SIZE=128
RATE_LIMIT_DELAY=0.1
```

### 4. Initialize the Database
```bash
sqlite3 smart_notes.db < smart_notes.sql
```

## 🎯 Usage

### Basic Usage
```bash
python smart_notes.py
```

### Python API Example
```python
from smart_notes import SmartNotesDB

# Initialize database
db = SmartNotesDB()

# Update embeddings for all notes
db.update_all_embeddings()

# Perform semantic search
results = db.semantic_search("quantum entanglement", limit=5)

for result in results:
    print(f"{result.title} (score: {result.distance:.4f})")
```

### SQL Query Examples

Search for notes by tag:
```sql
SELECT title, content 
FROM notes 
WHERE json_extract(metadata, '$.tags') LIKE '%quantum%';
```

Get popular tags:
```sql
SELECT * FROM popular_tags LIMIT 10;
```

View recent notes:
```sql
SELECT * FROM recent_notes;
```

## 📁 Project Structure

```
miniature-potato/
├── smart_notes.py          # Main Python application
├── smart_notes.sql         # Database schema and sample data
├── requirements.txt        # Full dependencies
├── requirements-core.txt   # Core dependencies only
├── .env.example           # Environment variables template
├── .gitignore            # Git ignore file
├── LICENSE                # MIT License file
└── README.md              # This file
```

## 🗄️ Database Schema

### Main Tables
- **notes** - Core table for storing notes with metadata
- **notes_fts** - Full-text search index
- **note_embeddings** - Vector embeddings for semantic search
- **categories** - Note categorization
- **note_links** - Relationships between notes
- **search_history** - Search analytics

### Views
- **recent_notes** - Latest 20 unarchived notes
- **popular_tags** - Tag usage statistics
- **note_statistics** - Overall database statistics

## ⚙️ Configuration

### Environment Variables
| Variable | Description | Default |
|----------|-------------|---------|
| `OPENAI_API_KEY` | Your OpenAI API key | Required |
| `DATABASE_PATH` | Path to SQLite database | `smart_notes.db` |
| `EMBEDDING_MODEL` | OpenAI embedding model | `text-embedding-3-small` |
| `EMBEDDING_DIMENSION` | Embedding vector size | `384` |
| `BATCH_SIZE` | Batch size for embedding generation | `10` |

## 🧪 Testing

Run tests with pytest:
```bash
pytest
```

With coverage report:
```bash
pytest --cov=smart_notes
```

## 🐛 Troubleshooting

### Common Issues

**sqlite-vss not loading:**
- The system will automatically fall back to FTS5 search
- To enable vector search, compile and install sqlite-vss extension

**OpenAI API errors:**
- Verify your API key in `.env` file
- Check your OpenAI account credits
- The system will fall back to text search if API fails

**Database locked errors:**
- The application uses WAL mode to minimize locking
- Ensure only one write operation at a time

## 📊 Performance Tips

1. **Batch Processing** - Use `add_embeddings_batch()` for multiple notes
2. **Caching** - Query embeddings are cached automatically
3. **Indexes** - Database includes optimized indexes
4. **Connection Pooling** - Use context managers for connections

## 🤝 Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## 📝 License

This project is licensed under the MIT License - see the LICENSE file for details.

## 🙏 Acknowledgments

- SQLite team for an amazing embedded database
- OpenAI for powerful embedding models
- sqlite-vss contributors for vector search capabilities

## 📧 Contact

For questions or suggestions, please open an issue on GitHub.

---
*Built with ❤️ for researchers and note-takers everywhere*
